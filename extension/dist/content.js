/*! For license information please see content.js.LICENSE.txt */
(()=>{function e(){var n,o,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function c(e,r,a,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return t(l,"_invoke",function(e,t,r){var a,i,c,s=0,l=r||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return a=e,i=0,c=n,f.n=t,u}};function p(e,t){for(i=e,c=t,o=0;!d&&s&&!r&&o<l.length;o++){var r,a=l[o],p=f.p,m=a[2];e>3?(r=m===t)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=p&&((r=e<2&&p<a[1])?(i=0,f.v=t,f.n=a[1]):p<m&&(r=e<3||a[0]>t||t>m)&&(a[4]=e,a[5]=t,f.n=m,i=0))}if(r||e>1)return u;throw d=!0,t}return function(r,l,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,m),i=l,c=m;(o=i<2?n:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,c)):f.n=c:f.v=c);try{if(s=2,a){if(i||(r="next"),o=a[r]){if(!(o=o.call(a,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,i<2&&(i=0)}else 1===i&&(o=a.return)&&o.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=n}else if((o=(d=f.n<0)?c:e.call(t,f))!==u)break}catch(e){a=n,i=1,c=e}finally{s=1}}return{value:o,done:d}}}(e,a,i),!0),l}var u={};function s(){}function l(){}function d(){}o=Object.getPrototypeOf;var f=[][a]?o(o([][a]())):(t(o={},a,function(){return this}),o),p=d.prototype=s.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,t(p,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,i,"GeneratorFunction"),t(p),t(p,i,"Generator"),t(p,a,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m}})()}function t(e,n,o,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,o,r){function i(n,o){t(e,n,function(e){return this._invoke(n,o,e)})}n?a?a(e,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[n]=o:(i("next",0),i("throw",1),i("return",2))},t(e,n,o,r)}function n(e,t,n,o,r,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(o,r)}console.log("zKMem Extension Content Script Loaded");var o=null,r=!1;function a(e){o=e,r=!0,console.log("Wallet connected in content script:",e),o&&(window.zkmemWallet={isConnected:!0,address:o.address,chainId:o.chainId,networkName:i(o.chainId),provider:o.provider,balance:o.balance,disconnect:function(){chrome.runtime.sendMessage({type:"WALLET_DISCONNECTED"})}},console.log("Wallet data injected into page:",window.zkmemWallet)),window.dispatchEvent(new CustomEvent("zkmem-wallet-connected",{detail:{walletData:e}}))}function i(e){switch(e){case 1:return"Ethereum Mainnet";case 5:return"Goerli Testnet";case 11155111:return"Sepolia Testnet";case 137:return"Polygon Mainnet";case 80001:return"Mumbai Testnet";case 56:return"BSC Mainnet";case 97:return"BSC Testnet";default:return"Chain ID: ".concat(e)}}function c(){return u.apply(this,arguments)}function u(){var t;return t=e().m(function t(){var n,o;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.runtime.sendMessage({type:"GET_WALLET_DATA"});case 1:(n=e.v)&&a(n),e.n=3;break;case 2:e.p=2,o=e.v,console.log("Failed to get wallet data:",o);case 3:return e.a(2)}},t,null,[[0,2]])}),u=function(){var e=this,o=arguments;return new Promise(function(r,a){var i=t.apply(e,o);function c(e){n(i,r,a,c,u,"next",e)}function u(e){n(i,r,a,c,u,"throw",e)}c(void 0)})},u.apply(this,arguments)}chrome.runtime.onMessage.addListener(function(e,t,n){switch(console.log("Content script received message:",e),e.type){case"WALLET_CONNECTED":a(e.walletData);break;case"WALLET_DISCONNECTED":o=null,r=!1,console.log("Wallet disconnected in content script"),window.zkmemWallet&&(window.zkmemWallet={isConnected:!1,disconnect:function(){console.log("Wallet already disconnected")}}),window.dispatchEvent(new CustomEvent("zkmem-wallet-disconnected"));break;default:console.log("Unknown message type:",e.type)}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c(),window.addEventListener("message",function(e){e.origin===window.location.origin&&"zkmem-request-wallet-data"===e.data.type&&e.source.postMessage({type:"zkmem-wallet-data-response",walletData:o,isConnected:r},e.origin)}),document.addEventListener("visibilitychange",function(){document.hidden||c()})})();